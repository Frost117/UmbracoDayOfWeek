{"version":3,"file":"client.js","sources":["../Client/dayoftheweek.ts"],"sourcesContent":["//@ts-ignore\nimport { LitElement, html, customElement, property, state } from \"@umbraco-cms/backoffice/external/lit\";\n//@ts-ignore\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\n//@ts-ignore\nimport { UMB_AUTH_CONTEXT, UmbAuthContext } from '@umbraco-cms/backoffice/auth';\n//@ts-ignore\nimport { UmbPropertyValueChangeEvent } from '@umbraco-cms/backoffice/property-editor';\n//@ts-ignore\nimport { type UmbPropertyEditorConfigCollection, UmbPropertyEditorUiElement } from \"@umbraco-cms/backoffice/property-editor\";\n//@ts-ignore\nimport type { UUISelectEvent } from '@umbraco-cms/backoffice/external/uui';\n\n@customElement('my-dayoftheweek')\nexport class MyDayOfTheWeekElement extends UmbElementMixin(LitElement) implements UmbPropertyEditorUiElement {\n  #selection: string = \"\";\n  \n  public get value(): string | undefined {\n    return this.#selection;\n  };\n\n  @property({ type: Number })\n  public defaultStartOfTheWeek: number = 1; // Monday by default\n  \n  @property({ type: String })\n  public set value(value: string | null | undefined) {\n    this.#selection = value || \"\";\n  }\n  \n  @property()\n  public myAuthToken: Promise<string> | undefined;\n  \n  @property({ type: Boolean, reflect: true })\n  readonly = false;\n  \n  @property({ attribute: false})\n  public set config(config: UmbPropertyEditorConfigCollection | undefined) {\n    \n    let defaultStartDayOfWeekConfigValue = config.getValueByAlias(\"startOfWeek\");\n    this._startOfWeek = defaultStartDayOfWeekConfigValue ? defaultStartDayOfWeekConfigValue : this.defaultStartOfTheWeek;\n\n    const items = defaultStartDayOfWeekConfigValue ? defaultStartDayOfWeekConfigValue : this.defaultStartOfTheWeek;\n    \n    if (Array.isArray(items) && items.length > 0) {\n      this._options =\n          typeof items[0] == 'string'\n              ? items.map((item) => ({ name: item, value: item, selected: this.#selection.includes(item) }))\n              : items.map((item) => ({\n                name: item.name,\n                value: item.value,\n                selected: this.#selection.includes(item.value),\n              }));\n    }\n  }\n  \n  //@ts-ignore\n  private _authorizationContext: UmbAuthContext;\n  \n  @state()\n  //@ts-ignore\n  private _startOfWeek: number;\n  \n  \n  @state()\n  //@ts-ignore\n  private _options: Array<Option> = [];\n  \n  #onChange(event: UUISelectEvent){\n    const value = event.target.value;\n    this.#setValue(value);\n  }\n  #setValue(value: string | null | undefined) {\n    if (!value) return;\n    this.value = value;\n    //@ts-ignore\n    this.dispatchEvent(new UmbPropertyValueChangeEvent());\n  }\n  \n  constructor() {\n    super();\n    // @ts-ignore\n    this.consumeContext(UMB_AUTH_CONTEXT, (context) => {\n      this._authorizationContext = context;\n      this.myAuthToken = context.getLatestToken();\n    });\n  }\n  render() {\n    return html`\n      <umb-input-dropdown-list\n          .options=${this._options.map(option => ({ \n            name: option.name, \n            value: option.value, \n            selected: option.selected }))}\n          @change=${this.#onChange}\n          ?readonly=${this.readonly}>\n      </umb-input-dropdown-list>\n    `\n  }\n    async connectedCallback(changed: any) {\n        super.connectedCallback(changed);\n        await this.getDayOfTheWeek();\n    }\n  private async getDayOfTheWeek() {\n    try{\n      const promiseToken: string | undefined = await this.myAuthToken;\n      const headers = {\n        'Authorization': `Bearer ${promiseToken}`\n      };\n      \n      const response = await fetch(`/umbraco/management/api/v1/get-dropdown-value-list?startDayOfTheWeek=${this._startOfWeek}`, {headers}).then(response => response.json());\n      \n      this._options = response.map((item: any) => {\n        //@ts-ignore\n        let localizedTerm = this.localize.term(`DayOfTheWeek_d${item.id}`);\n        return{\n          name: localizedTerm !== `DayOfTheWeek_d${item.id}` ? localizedTerm : item.defaultName,\n          value: item.id,\n          selected: this.value ? this.value == item.id : false\n        }\n      });\n      \n      console.log(this._options);\n\n    } catch (e) {\n      console.error(e);\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'my-dayoftheweek': MyDayOfTheWeekElement\n  }\n}\n"],"names":["_selection","_MyDayOfTheWeekElement_instances","onChange_fn","setValue_fn","MyDayOfTheWeekElement","UmbElementMixin","LitElement","__privateAdd","UMB_AUTH_CONTEXT","context","__privateGet","value","__privateSet","config","defaultStartDayOfWeekConfigValue","items","item","html","option","__privateMethod","changed","headers","response","localizedTerm","event","UmbPropertyValueChangeEvent","__decorateClass","property","state","customElement"],"mappings":"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"}