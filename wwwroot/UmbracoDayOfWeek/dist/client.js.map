{"version":3,"file":"client.js","sources":["../src/dayoftheweek.ts"],"sourcesContent":["// @ts-ignore\nimport { LitElement, html, customElement, property, state } from \"@umbraco-cms/backoffice/external/lit\";\n// @ts-ignore\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\n// @ts-ignore\nimport { UMB_AUTH_CONTEXT, UmbAuthContext } from '@umbraco-cms/backoffice/auth';\n// @ts-ignore\nimport { UmbPropertyValueChangeEvent } from '@umbraco-cms/backoffice/property-editor';\n// @ts-ignore\nimport { type UmbPropertyEditorConfigCollection, UmbPropertyEditorUiElement } from \"@umbraco-cms/backoffice/property-editor\";\n// @ts-ignore\nimport type { UUISelectEvent } from '@umbraco-cms/backoffice/external/uui';\n\n@customElement('my-dayoftheweek')\nexport class MyDayOfTheWeekElement extends UmbElementMixin(LitElement) implements UmbPropertyEditorUiElement {\n  #selection = -1;\n  \n  public get value(){\n    return this.#selection;\n  };\n  \n  @property()\n  public displayList: Array<any> = [];\n  \n  @property()\n  public defaultStartOfTheWeek = 1; // Monday by default\n  \n  @property()\n  public set value(value) {\n    this.#selection = value;\n  }\n  \n  @property()\n  public myAuthToken: Promise<string> | undefined;\n  \n  @property()\n  public set config(config: UmbPropertyEditorConfigCollection) {\n    let defaultStartDayOfWeekConfigValue = config.getValueByAlias(\"startOfWeek\");\n    this._startOfWeek = defaultStartDayOfWeekConfigValue ? defaultStartDayOfWeekConfigValue : this.defaultStartOfTheWeek;\n  }\n  // @ts-ignore  \n  private _authorizationContext: UmbAuthContext;\n  \n  @state()\n  // @ts-ignore\n  private _startOfWeek;\n  \n  @state()\n  // @ts-ignore\n  private _options: Array<Option> = [];\n  \n  // @ts-ignore\n  #mapList(){\n    // @ts-ignore\n    this.displayList = this.list.map(item =>({\n      // @ts-ignore\n      name: this.localize.term(`DayOfTheWeek_d${item.id}`) || item.DefaultName,\n      value: item.id,\n      selected: this.value || this.value === 0 ? this.value == item.id : false\n    }));\n    // @ts-ignore\n    this.requestUpdate();\n    console.log(this.displayList)\n  }\n  \n  #onChange(event: UUISelectEvent){\n    this.value = +event.target.value;\n    // @ts-ignore\n    this.dispatchEvent(new UmbPropertyValueChangeEvent())\n    this.#mapList()\n\n  }\n  constructor() {\n    super();\n    // @ts-ignore\n    this.consumeContext(UMB_AUTH_CONTEXT, (context) => {\n      this._authorizationContext = context;\n      this.myAuthToken = context.getLatestToken();\n    });\n  }\n  render() {\n    return html`\n      <umb-input-dropdown-list\n          .options=${this.displayList}\n          @change=${this.#onChange}>\n      </umb-input-dropdown-list>\n    `\n  }\n    async connectedCallback() {\n      super.connectedCallback();\n      const defaultStartDayOfWeekConfigValue = this._startOfWeek;\n      // @ts-ignore\n      this.defaultStartDayOfWeekValue = defaultStartDayOfWeekConfigValue >= 0 && defaultStartDayOfWeekConfigValue < 7 ? defaultStartDayOfWeekConfigValue : this.defaultStartDayOfWeekValue;\n      // @ts-ignore\n      this.consumeContext(UMB_AUTH_CONTEXT, (context) => {\n        // @ts-ignore\n        context.getLatestToken().then(promiseToken => {\n          try {\n            const headers = {\n              Authorization: `Bearer ${promiseToken}`\n            };\n            // @ts-ignore\n            fetch(`/umbraco/management/api/v1/get-dropdown-value-list?startDayOfTheWeek=${this.defaultStartDayOfWeekValue}`, {headers}).then(response => response.json())\n                .then(results => {\n                  // @ts-ignore\n                  this.list = results;\n                  this.#mapList()\n                })\n          } catch (e) {\n            console.error(e);\n          }\n        });\n      });\n    }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'my-dayoftheweek': MyDayOfTheWeekElement\n  }\n}\n"],"names":["_selection","_MyDayOfTheWeekElement_instances","mapList_fn","onChange_fn","MyDayOfTheWeekElement","UmbElementMixin","LitElement","__privateAdd","UMB_AUTH_CONTEXT","context","__privateGet","value","__privateSet","config","defaultStartDayOfWeekConfigValue","html","__privateMethod","promiseToken","headers","response","results","e","item","event","UmbPropertyValueChangeEvent","__decorateClass","property","state","customElement"],"mappings":"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"}